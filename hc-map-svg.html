<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>代养</title>
</head>

<body>
    <iframe src="https://sawsclong.github.io/gg/合川区h1000.svg"></iframe>
    <div id="popup">
        <div class="header">
            <div class="close">
                <span>地区</span>
                ×
            </div>
            <img src="https://s2.loli.net/2024/04/23/3P6gv4S1mLMh7wo.png">
            <div class="info">剩余猪仔<span>73只</span></div>
        </div>
        <div class="bottom">
            <div class="button">
                查看详情
            </div>
        </div>
    </div>
    <script>
        const body = document.querySelector('body');
        const ig = document.querySelector('iframe')
        console.log(ig)
        let activedDom = null;
        ig.onload = () => {
            const pathDoms = ig.contentDocument.querySelectorAll('path')
            for (let j = 0; j < pathDoms.length; j++) {
                pathDoms[j].style.fill = 'rgba(0,0,0,0.4)';
                pathDoms[j].style.transition = 'all 0.3s ease'
            }
            const svg = ig.contentDocument.querySelector("svg");
            svg.addEventListener('click', (e) => {
                let activeName = e.target.getAttribute('name');
                activedDom = e.target;
                // e.target.classList.add("active");
                e.target.style.stroke = "white"
                e.target.style.strokeWidth = 5;
                e.target.style.fillOpacity = 0;
                e.target.style.zIndex = 100000;
                console.log(e)
                document.getElementById('popup').style.display = 'block'
                console.log(document.querySelector('.close>span'))
                document.querySelector('.close>span').innerText = activeName;
                document.querySelector('.info>span').innerText = Math.floor(Math.random() * 100) + '只'
                for (let i = 0; i < pathDoms.length; i++) {
                    if (pathDoms[i].getAttribute('name') != activeName) {
                        pathDoms[i].style.strokeWidth = 0;
                        // pathDoms[i].style.fillOpacity = 1;
                    }
                }
            })

            const closeButton = document.querySelector('.close')
            closeButton.addEventListener('click', () => {
                document.getElementById('popup').style.display = 'none'
                activedDom.style.strokeWidth = 0;
            })
        }
    </script>
    <script type="text/javascript">
        var userAgent = navigator.userAgent;
        if (userAgent.indexOf('AlipayClient') > -1) {
            // 支付宝小程序的 JS-SDK 防止 404 需要动态加载，如果不需要兼容支付宝小程序，则无需引用此 JS 文件。
            document.writeln('<script src="https://appx/web-view.min.js"' + '>' + '<' + '/' + 'script>');
        } else if (/QQ/i.test(userAgent) && /miniProgram/i.test(userAgent)) {
            // QQ 小程序
            document.write(
                '<script type="text/javascript" src="https://qqq.gtimg.cn/miniprogram/webview_jssdk/qqjssdk-1.0.0.js"><\/script>'
            );
        } else if (/miniProgram/i.test(userAgent) && /micromessenger/i.test(userAgent)) {
            // 微信小程序 JS-SDK 如果不需要兼容微信小程序，则无需引用此 JS 文件。
            document.write('<script type="text/javascript" src="https://res.wx.qq.com/open/js/jweixin-1.4.0.js"><\/script>');
        } else if (/toutiaomicroapp/i.test(userAgent)) {
            // 头条小程序 JS-SDK 如果不需要兼容头条小程序，则无需引用此 JS 文件。
            document.write(
                '<script type="text/javascript" src="https://s3.pstatp.com/toutiao/tmajssdk/jssdk-1.0.1.js"><\/script>');
        } else if (/swan/i.test(userAgent)) {
            // 百度小程序 JS-SDK 如果不需要兼容百度小程序，则无需引用此 JS 文件。
            document.write(
                '<script type="text/javascript" src="https://b.bdstatic.com/searchbox/icms/searchbox/js/swan-2.0.18.js"><\/script>'
            );
        } else if (/quickapp/i.test(userAgent)) {
            // quickapp
            document.write('<script type="text/javascript" src="https://quickapp/jssdk.webview.min.js"><\/script>');
        }
        if (!/toutiaomicroapp/i.test(userAgent)) {
            document.querySelector('.post-message-section').style.visibility = 'visible';
        }
    </script>
    <script type="text/javascript"
        src="https://gitcode.net/dcloud/hello-uni-app-x/-/blob/alpha/hybrid/html/uni.webview.1.5.5.js"></script>
    <script type="text/javascript">
        // 待触发 `UniAppJSBridgeReady` 事件后，即可调用 uni 的 API。
        document.addEventListener('UniAppJSBridgeReady', function () {
            // uni.postMessage({
            //     data: {
            //         action: 'message'
            //     }
            // });
            uni.getEnv(function (res) {
                console.log('当前环境：' + JSON.stringify(res));
            });

            document.querySelector('.button').addEventListener('click', function () {
                console.log(document.querySelector('.close>span').innerText)
                uni.navigateTo({
                    url: `/pages/unadopted-piglets/UnadoptedPiglets?district=${document.querySelector('.close>span').innerText}`
                });
            });

            // document.querySelector('.btn-list').addEventListener('click', function (evt) {
            //     var target = evt.target;
            //     if (target.tagName === 'BUTTON') {
            //         var action = target.getAttribute('data-action');
            //         switch (action) {
            //             case 'switchTab':
            //                 uni.switchTab({
            //                     url: '/pages/tabBar/API/API'
            //                 });
            //                 break;
            //             case 'reLaunch':
            //                 uni.reLaunch({
            //                     url: '/pages/tabBar/component/component'
            //                 });
            //                 break;
            //             case 'navigateBack':
            //                 uni.navigateBack({
            //                     delta: 1
            //                 });
            //                 break;
            //             default:
            //                 uni[action]({
            //                     url: '/pages/component/button/button'
            //                 });
            //                 break;
            //         }
            //     }
            // });
            // document.getElementById('postMessage').addEventListener('click', function () {
            //     uni.postMessage({
            //         data: {
            //             action: 'message'
            //         }
            //     });
            // });
        });
    </script>
</body>

<style>
    body {
        position: relative;
        margin: 0;
        padding: 0;
    }

    iframe {
        width: 100vw;
        height: 100vh;
        border: 0;
        overflow: scroll;
    }

    svg {
        transform: scale(0.5);
    }

    g image {
        cursor: pointer;
    }

    #popup {
        width: 40%;
        aspect-ratio: 0.7/1;
        background-color: white;
        position: fixed;
        right: 30px;
        top: 50%;
        transform: translateY(-50%);
        border-radius: 15px;
        padding: 20px;
        transition: all 1s;
        display: none;
    }

    .header {
        width: 100%;
        height: 80%;
        display: flex;
        flex-direction: column;
        align-items: space-around;
        justify-content: flex-start;
    }

    .header>.close {
        width: 100%;
        height: 8%;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 30px;
        cursor: pointer;
        margin-top: -10px;
    }

    .header>.close>span {
        font-size: 20px;
        margin-top: -5px;
        width: 90%;
        overflow: hidden;
        text-overflow: ellipsis;
        /* 文本不换行 */
        white-space: nowrap;
    }

    .header>img {
        width: 100%;
        height: 80%;
        object-fit: cover;
        border-radius: 30px;
    }

    .header>.info {
        width: 100%;
        height: 12%;
        display: flex;
        justify-content: center;
        align-items: center;
        font-size: 20px;
    }

    .header>.info>span {
        font-size: 25px;
        font-weight: 600;
        color: rgb(255, 69, 69);
    }

    .bottom {
        width: 100%;
        height: 20%;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .button {
        width: 100%;
        height: 40px;
        border-radius: 20px;
        background-color: rgb(23, 25, 26);
        color: white;
        display: flex;
        justify-content: center;
        align-items: center;
        cursor: pointer;
    }

    .pic {
        display: none;
    }
</style>

</html>